<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Unifroce one-click, free malware scanner</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
  <style>
    .board {
      position: relative;
      background-color: #F0F8FF;
      box-shadow: 0 0 10px rgba(0,0,0,0.5);
      border-radius: 3px;
      padding-bottom: 20px;
      text-align: center;
    }

    .block-legend {
      display: flex;
      justify-content: space-between;
      margin-top: 30px;
      font-size: 14px;
    }

    .block-legend-ps {
      text-align: left;
      font-size: 14px;
    }

    .column-legend {
      width: 45%;
      text-align: left;
    }
  </style>
</head>
<body style="background-color: #3487C9; color: #444;">
  <div class="container">
    <div class="row" style="margin-top: 80px;">
      <div class="col-sm-12 board">
        <div style="position: absolute; top: -50px; text-align: center; width: 100%;">
            <img src="https://github.com/svfcode/ct-sec-scan/blob/main/logo.png?raw=true" alt="Cleantalk logo" style="height: 100px;">
        </div>
        <div style="text-align: center; margin-top: 70px;">
            <h1> - Free malware scanner is ready to go - </h1>
        </div>
        <div class="mt-4" style="text-align: center; width: 100%;">
          <button type="button" class="btn btn-primary">Perform scan</button>
        </div>

        <div class="progress mt-4 center" style="width: 75%; margin-left: 12%;" role="progressbar" aria-label="Example with label" aria-valuenow="25" aria-valuemin="0" aria-valuemax="100">
          <div id="progress_main" class="progress-bar" style="width: 25%">25%</div>
        </div>

        <div class="card mt-4">
          <p id="help_text" class="mt-2">Process of scanning, please don't leave this page.</p>
          <div class="card-body">
            <table id="verdict" class="table table-striped d-none">
              <tr>
                <th>path</th>
                <th>detected</th>
                <th>last modified</th>
              </tr>
            </table>
          </div>
          <div id="progress_log" class="card-body">
            <div class="card" style="max-height: 300px; overflow: auto;">
              <table class="table table-striped-columns">
                <tr>
                  <th>stage</th>
                  <th>result</th>
                  <th>duration</th>
                </tr>
                <tr>
                  <td>receiving signatures from cloud</td>
                  <td>
                    <div class="progress mt-4 center" role="progressbar" aria-label="Example with label" aria-valuenow="25" aria-valuemin="0" aria-valuemax="100">
                      <div class="progress-bar" style="width: 25%">25%</div>
                    </div>
                  </td>
                  <td>1s</td>
                </tr>
                <tr>
                  <td>prepare file system</td>
                  <td>
                    <div class="progress mt-4 center" role="progressbar" aria-label="Example with label" aria-valuenow="25" aria-valuemin="0" aria-valuemax="100">
                      <div class="progress-bar" style="width: 25%">25%</div>
                    </div>
                  </td>
                  <td>1s</td>
                </tr>
                <tr>
                  <td>check signatures</td>
                  <td>
                    <div class="progress mt-4 center" role="progressbar" aria-label="Example with label" aria-valuenow="25" aria-valuemin="0" aria-valuemax="100">
                      <div class="progress-bar" style="width: 25%">25%</div>
                    </div>
                  </td>
                  <td>1s</td>
                </tr>
              </table>
          </div>

          <div class="block-legend">
            <div class="column-legend">
              <ul>
                <h4>Available actions on the found files:</h4>
                <li>
                  <strong>Delete:</strong> 
                  Delete the chosen file from your website file system in a safe way. You should be careful with this action as there is no turing back.
                </li>
                <li>
                  <strong>View:</strong> 
                  View the chosen file.
                </li>
                <li>
                  <strong>Send for Analysis:</strong> 
                  Send the chosen file to the Security by CleanTalk Cloud for analysis.
                </li>
                <li>
                  <strong>Approve:</strong> 
                  Approve the chosen file so it will not be scanned again. You can always disapprove it in the "Approved" category.
                </li>
                <li>
                  <strong>Quarantine:</strong> 
                  Put the chosen file to quarantine where it can not harm the website.
                </li>
                <li>
                  <strong>Replace:</strong> 
                  Restore the initial state of the chosen file if the file is accessible. It applies only to the WordPress core files.
                </li>
                <li>
                  <strong>Compare:</strong> 
                  View the difference between the original WordPress core file and the one you have in your website.
                </li>
                <li>
                  <strong>View Malicious Code:</strong> 
                  View malicious code that was found by the scanner, so you can inspect it more clearly.
                </li>
                The actions are available only after scanning your website.
              </ul>
            </div>
            <div class="column-legend">
              <div id="spbcscan-results-log-caption">
                <h4>File Scan Results:</h4>
                <p>
                  <b>OK</b> - file is fine.
                </p>
                <p>
                  <b>APPROVED</b> - file is approved by the user.
                </p>
                <p>
                  <b>APPROVED_BY_CT</b> - file is approved by Security by CleanTalk.
                </p>
                <p>
                  <b>MODIFIED</b> - file is different from the original one.
                </p>
                <p>
                  <b>INFECTED</b> - file is infected.
                </p>
                <p>
                  <b>QUARANTINED</b> - file has been quarantined.
                </p>
                <p>
                  <b>UNKNOWN</b> - file of unknown origin.
                </p>
              </div>
            </div>
          </div>
          <div class="block-legend-ps">
            <p>
              * Website total files - only executable files (*.php, *.html, *.htm, *.phtml, *.shtml, *.phar, *.odf) except for 
              the quarantined files, files of zero size and files larger than the acceptable size (2 MB).
              Files scanned - files have been checked. Some files will be added to the scan if the scanner deems it necessary.
            </p>
            <p>
              This version of Uniforce just a malware scanner that you have to run it yourself. If you need Automatically daily 
              scans, Brute-Force protection, Web application firewall and Security FireWall you are welcome to download the full
              version of Uniforce <a href="https://cleantalk.org/help/install-security">https://cleantalk.org/help/install-security</a>
            </p>
            <p>
              Uniforce one-click malware scanner is product of CleanTalk Inc. Have questions? You are welcome at <a href="https://cleantalk.org/my/support/open">https://cleantalk.org/my/support/open</a>
            </p>
          </div>
        </div>
      </div>
    </div>
  </div>
  
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
  <script>
    let verdict = [];
    function runStage(stage) {
      $.ajax({
          url: document.location.href,
          method: 'POST',
          dataType: 'json',
          async: false,
          data: {
            "method": stage
          },
          success: function(data){
            console.log(data)
            if (stage === 'check_signatures') {
              verdict = data['verdict'];
            }
          },
          error: function(a) {
            console.log(a)
          }
      });
    }

    function renderVerdict() {
      console.log(verdict);

      $('#progress_log').addClass('d-none');
      $('#verdict').removeClass('d-none');
      $('#progress_main').width('100%');
      $('#progress_main').text('100%');

      if (verdict.length > 0) {
        let txt = 'You have a malware on site, please use <a href="https://cleantalk.org/help/install-uniforce-security" target="_blank">Uniforce</a> full version to detect and autocure malweres.';
        $('#help_text').html(txt).css({'color': 'red'});
      }

      let content = '';
      let d, minutes, seconds, date;
      shortMonthName = new Intl.DateTimeFormat("en-US", { month: "short" }).format;
      verdict.forEach(el => {
        d = new Date(Number(el[2]) * 1000);
        minutes = String(d.getMinutes()).padStart(2, '0');
        seconds = String(d.getSeconds()).padStart(2, '0');
        date = shortMonthName(d) + ' ' + d.getDate() + ' ' + d.getFullYear() + ' ' + d.getHours() + ':' + minutes + ':' + seconds;

        content += [
          '<tr>',
          '<td>',
          el[0],
          '</td>',
          '<td>',
          el[1],
          '</td>',
          '<td>',
          date,
          '</td>',
          '</td>',
        ].join('');
      });
      $('#verdict tr:last').after(content);
    }

    let stages = [
      'prepare_file_system',
      'receive_signatures',
      'make_file_system_cast',
      'check_signatures',
    ];

    $(document).ready(function() {
      stages.forEach(stage => {
        runStage(stage);
      });

      if (verdict.length > 0) {
        renderVerdict();
      }
    });
  </script>
</body>
</html>